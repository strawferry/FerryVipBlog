<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-center-atom.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"strawferry.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.18.0","exturl":true,"sidebar":{"position":"right","width":320,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"show_result":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="好好过一生">
<meta property="og:type" content="website">
<meta property="og:title" content="FerryVip&#39;s Blog">
<meta property="og:url" content="https://strawferry.github.io/page/3/index.html">
<meta property="og:site_name" content="FerryVip&#39;s Blog">
<meta property="og:description" content="好好过一生">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="FerryVip">
<meta property="article:tag" content="前端,分享,博客,前端开发,前端技术">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://strawferry.github.io/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>FerryVip's Blog - 技术分享</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-88853535-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-88853535-1","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kt6ijw4ygg");
  </script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">FerryVip's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">技术分享</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档<span class="badge">40</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="FerryVip"
      src="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
  <p class="site-author-name" itemprop="name">FerryVip</p>
  <div class="site-description" itemprop="description">好好过一生</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnk=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;strawferry"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly94aWFvaG9uZ3NodXNoYXJlLm9ubGluZQ==" title="Share工具 → https:&#x2F;&#x2F;xiaohongshushare.online"><i class="fa fa-link fa-fw"></i>Share工具</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2019/02/22/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%20Jenkins%20%E5%90%88%E5%B9%B6%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E4%BD%93%E9%AA%8C%E7%89%88%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/02/22/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%20Jenkins%20%E5%90%88%E5%B9%B6%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E4%BD%93%E9%AA%8C%E7%89%88%E6%9C%AC/" class="post-title-link" itemprop="url">微信小程序开发 Jenkins 合并代码提交体验版本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-02-22 14:50:48" itemprop="dateCreated datePublished" datetime="2019-02-22T14:50:48+08:00">2019-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="微信小程序开发-Jenkins-合并代码提交体验版本"><a href="#微信小程序开发-Jenkins-合并代码提交体验版本" class="headerlink" title="微信小程序开发 Jenkins 合并代码提交体验版本"></a>微信小程序开发 Jenkins 合并代码提交体验版本</h1><h2 id="1-起因"><a href="#1-起因" class="headerlink" title="1. 起因"></a>1. 起因</h2><p>最近公司项目在做小程序开发,有多个小伙伴一起开发,测试的小伙伴也要加入测试,为了做到敏捷开发,我这个懒人就在想有啥办法可以做到这点,最后发现微信的小程序工具提供<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXJzLndlaXhpbi5xcS5jb20vbWluaXByb2dyYW0vZGV2L2RldnRvb2xzL2NsaS5odG1s">命令行调用<i class="fa fa-external-link-alt"></i></span>,查看其文档发现了新大陆,也就有了这篇文章;</p>
<h2 id="2-流程"><a href="#2-流程" class="headerlink" title="2. 流程"></a>2. 流程</h2><ol>
<li>开发人员开发后代码推到 git 仓库;</li>
<li>测试人员或开发触发 Jenkins 构建;</li>
<li>通过微信的工具上传微信小程序最新代码,并通过钉钉机器人通知打包成功;</li>
<li>测试就可以打开微信小程序的体验版开始体验最新的修改;</li>
</ol>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1g0ge56olm3j217m0loacj.jpg"></p>
<h2 id="3-Jenkins-配置"><a href="#3-Jenkins-配置" class="headerlink" title="3. Jenkins 配置"></a>3. Jenkins 配置</h2><p><strong>1.</strong> 配置参数化构建, 主要是配置了 接口请求环境,和打包的 Git 分支</p>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1g0gek8npfvj21ho14adk3.jpg"></p>
<p><strong>2.</strong> Git 配置</p>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1g0gem3ja0vj21i60v8q6p.jpg"></p>
<p><strong>3.</strong> Build 执行 shell 脚本</p>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1g0gena00thj21ik0s4adu.jpg"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">echo ------------ 构建分支 --------------</span><br><span class="line">echo $BRANCH </span><br><span class="line">echo ------------ 打包环境 --------------</span><br><span class="line">echo $ENV</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">导入 node 环境</span></span><br><span class="line">export PATH=$PATH:/usr/local/bin </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行 接口请求环境的 替换操作</span></span><br><span class="line">node env.js $ENV</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上传最新修改到微信小程序</span></span><br><span class="line">/Applications/wechatwebdevtools.app/Contents/MacOS/cli -u 1.0.0@$PWD --upload-desc &#x27;Jenkins 小程序更新最新代码了,快去体验版查看&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上传成功后发送钉钉通知</span></span><br><span class="line">node index.js $ENV $BRANCH</span><br></pre></td></tr></table></figure>

<h2 id="4-微信开发工具配置"><a href="#4-微信开发工具配置" class="headerlink" title="4. 微信开发工具配置"></a>4. 微信开发工具配置</h2><ol>
<li>微信开发工具登录并打开设置里面安全的服务端口,还有就是微信版本管理把这个上传的微信版本选为体验版,这样下次再上传上去体验版就可以下载最新的上传修改了;</li>
</ol>
<blockquote>
<p>本人手上是有一台 Mac 电脑专门用来打包 App 的,所以只讲了 Mac 的,但道理是差不多一样的,可以自己折腾 Windows 的系统,要在这台打包电脑安装 <code>Jenkins</code> 还有 <code>微信开发工具</code>;(因为自己脚本写的太差了,所以有两个地方用到了 <code>node</code> 来实现,所以还安装了 <code>node</code> 环境);</p>
</blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1g0ggb5q8r8j227i1psqmv.jpg"></p>
<h2 id="钉钉设置机器人"><a href="#钉钉设置机器人" class="headerlink" title="钉钉设置机器人"></a>钉钉设置机器人</h2><p><span class="exturl" data-url="aHR0cHM6Ly9nYmxvZy5mZXJyeXZpcC5jb20vMjAxOC8wMi8yNi9Mb2c0anMlMjAtJTIwQXBwZW5kZXJzJTIwJUU1JUJDJTgwJUU1JThGJTkxLCVFNiVCNiU4OCVFNiU4MSVBRiVFNyU5QiVCNCVFNSU4RiU5MSVFOSU5MiU4OSVFOSU5MiU4OSVFNiU5QyVCQSVFNSU5OSVBOCVFNCVCQSVCQS8=">之前我已经写了几个涉及钉钉机器人的配置,直接看之前的配置<i class="fa fa-external-link-alt"></i></span></p>
<p>配置完成后,获取里面的 token</p>
<h2 id="5-主要代码配置"><a href="#5-主要代码配置" class="headerlink" title="5. 主要代码配置"></a>5. 主要代码配置</h2><p><strong>1.</strong> 配置环境的文件 <code>&#39;./config/index.js&#39;</code> </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局配置文件</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable constant_">HOST</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable constant_">USERHOST</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable constant_">ENV</span> = <span class="string">&#x27;DEV&#x27;</span>; <span class="comment">// 设置环境 测试 DEV, 正式环境 PROD</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable constant_">ENV</span> === <span class="string">&#x27;PROD&#x27;</span>) &#123;</span><br><span class="line">  <span class="comment">// 正式环境 host</span></span><br><span class="line">  <span class="variable constant_">HOST</span> = <span class="string">&#x27;https://api.prod.com&#x27;</span>;</span><br><span class="line">  <span class="variable constant_">USERHOST</span> = <span class="string">&#x27;https://user.prod.com&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// 测试环境 host</span></span><br><span class="line">  <span class="variable constant_">HOST</span> = <span class="string">&#x27;https://api.dev.com&#x27;</span>;</span><br><span class="line">  <span class="variable constant_">USERHOST</span> = <span class="string">&#x27;https://user.dev.com&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">ENV</span>: <span class="variable constant_">ENV</span>,</span><br><span class="line">  <span class="attr">HOST</span>: <span class="variable constant_">HOST</span>,</span><br><span class="line">  <span class="attr">USERHOST</span>: <span class="variable constant_">USERHOST</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2.</strong> 替换接口环境的文件 <code>&#39;./env.js&#39;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ENV</span> = process.<span class="property">argv</span>[<span class="number">2</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`/************* 替换环境为 <span class="subst">$&#123;ENV&#125;</span> 开始 *************/`</span>);</span><br><span class="line"><span class="comment">// 环境文本</span></span><br><span class="line"><span class="keyword">const</span> prodTep = <span class="string">`</span></span><br><span class="line"><span class="string">// 全局配置文件</span></span><br><span class="line"><span class="string">let HOST = &#x27;&#x27;, USERHOST = &#x27;&#x27;;</span></span><br><span class="line"><span class="string">let ENV = &#x27;<span class="subst">$&#123;ENV&#125;</span>&#x27;; // 设置环境 测试 DEV, 正式环境 PROD</span></span><br><span class="line"><span class="string">if (ENV === &#x27;PROD&#x27;) &#123;</span></span><br><span class="line"><span class="string">  // 正式环境 host</span></span><br><span class="line"><span class="string">  HOST = &#x27;https://api.prod.com&#x27;;</span></span><br><span class="line"><span class="string">  USERHOST = &#x27;https://user.prod.com&#x27;;</span></span><br><span class="line"><span class="string">&#125; else &#123;</span></span><br><span class="line"><span class="string">  // 测试环境 host</span></span><br><span class="line"><span class="string">  HOST = &#x27;https://api.dev.com&#x27;;</span></span><br><span class="line"><span class="string">  USERHOST = &#x27;https://user.dev.com&#x27;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">module.exports = &#123;</span></span><br><span class="line"><span class="string">  ENV: ENV,</span></span><br><span class="line"><span class="string">  HOST: HOST,</span></span><br><span class="line"><span class="string">  USERHOST: USERHOST,</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line">process.<span class="title function_">chdir</span>(<span class="string">`./config`</span>); <span class="comment">// cd $1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`/************* 前往 config 文件夹,并替换写入文件 *************/`</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(prodTep);</span><br><span class="line">fs.<span class="title function_">writeFileSync</span>(<span class="string">&#x27;index.js&#x27;</span>, prodTep);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`/************* 替换环境为 <span class="subst">$&#123;ENV&#125;</span> 成功 *************/`</span>);</span><br><span class="line">process.<span class="title function_">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>3.</strong> 发送钉钉消息的文件 <code>&#39;./index.js&#39;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">ENV</span> = process.<span class="property">argv</span>[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">const</span> branch = process.<span class="property">argv</span>[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ddtoken = <span class="string">&#x27;you-dingding-token&#x27;</span>; <span class="comment">// 钉钉机器人 token</span></span><br><span class="line"><span class="keyword">const</span> qrurl = <span class="string">&#x27;you-qrcode-url&#x27;</span>;  <span class="comment">// 微信体验版的 二维码地址</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tokens = [</span><br><span class="line">  wscUrl,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> env = <span class="variable constant_">ENV</span> === <span class="string">&#x27;PROD&#x27;</span> ? <span class="string">&#x27;正式环境&#x27;</span> : <span class="string">&#x27;测试环境&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> exec = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="property">exec</span>;</span><br><span class="line"><span class="comment">//  git 最近 5 条修改的 commit 信息</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">`git log -5 --date=format:&#x27;%Y-%m-%d %H:%M:%S&#x27; --pretty=format:&quot;* %cd - %s &quot;`</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">runExec</span>(<span class="params">cmdStr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">exec</span>(cmdStr, <span class="keyword">function</span> (<span class="params">err, stdout, stderr</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;runExec error:&#x27;</span> + stderr);</span><br><span class="line">        <span class="title function_">reject</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// console.log(stdout);</span></span><br><span class="line">        <span class="title function_">resolve</span>(stdout);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> gitlog = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="title function_">runExec</span>(str).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; tokens.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> token = tokens[i];</span><br><span class="line">    gitlog = res;</span><br><span class="line">    <span class="title function_">sendDing</span>(token, gitlog)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendDing</span>(<span class="params">token, gitlog</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> https = <span class="built_in">require</span>(<span class="string">&#x27;https&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> options = &#123;</span><br><span class="line">    <span class="attr">hostname</span>: <span class="string">&quot;oapi.dingtalk.com&quot;</span>, <span class="comment">// 呼叫的域名</span></span><br><span class="line">    <span class="attr">port</span>: <span class="number">443</span>,				<span class="comment">// 端口固定</span></span><br><span class="line">    <span class="attr">path</span>: <span class="string">`/robot/send?access_token=<span class="subst">$&#123;token&#125;</span>`</span>,				<span class="comment">// 请求的api名称</span></span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,			<span class="comment">// get和post请求</span></span><br><span class="line">    <span class="attr">json</span>: <span class="literal">true</span>,				<span class="comment">// 此地方表示json</span></span><br><span class="line">    <span class="attr">rejectUnauthorized</span>: <span class="literal">true</span>,  <span class="comment">//请校验服务器证书，否则ssl没有意义。</span></span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json;version=2.0&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,             <span class="comment">//此地方和json很有关联，需要注意</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> post_data = &#123;</span><br><span class="line">    <span class="string">&quot;msgtype&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">    <span class="string">&quot;markdown&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;title&quot;</span>: <span class="string">&quot;小程序新包更新&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">`# 小程序新包发布 \n \n &gt; 分支: <span class="subst">$&#123;branch&#125;</span> \n \n &gt; 服务器环境: <span class="subst">$&#123;env&#125;</span> \n \n &gt; 更新内容: \n \n <span class="subst">$&#123;gitlog&#125;</span>  \n \n &gt; 微信扫码体验小程序: ![](<span class="subst">$&#123;qrurl&#125;</span>)`</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> json = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(post_data);</span><br><span class="line">  <span class="keyword">var</span> req = https.<span class="title function_">request</span>(options, <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">setEncoding</span>(<span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;problem with request: &#x27;</span> + e.<span class="property">message</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  req.<span class="title function_">write</span>(json);</span><br><span class="line">  req.<span class="title function_">end</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-最终钉钉消息效果"><a href="#6-最终钉钉消息效果" class="headerlink" title="6. 最终钉钉消息效果"></a>6. 最终钉钉消息效果</h2><p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1g0ggu8vrcsj20ui1catej.jpg"></p>
<h2 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h2><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvd2VhcHBqZW5raW5z">GitHub 仓库地址<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<h2 id="个人博客"><a href="#个人博客" class="headerlink" title="个人博客"></a>个人博客</h2><p><strong>博客地址:</strong><br><span class="exturl" data-url="aHR0cHM6Ly9nYmxvZy5mZXJyeXZpcC5jb20v">https://gblog.ferryvip.com/<i class="fa fa-external-link-alt"></i></span> </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2018/10/31/CodePush%20%E7%83%AD%E6%9B%B4%E6%96%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%B9%E7%AA%97%E6%8F%90%E7%A4%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/31/CodePush%20%E7%83%AD%E6%9B%B4%E6%96%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%B9%E7%AA%97%E6%8F%90%E7%A4%BA/" class="post-title-link" itemprop="url">CodePush 热更新自定义弹窗提示</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-31 17:09:16" itemprop="dateCreated datePublished" datetime="2018-10-31T17:09:16+08:00">2018-10-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="项目说明"><a href="#项目说明" class="headerlink" title="项目说明"></a>项目说明</h2><p>在用 ReactNative 开发 App 时,会用到 CodePush 做应用的热更新,但是在升级的时候没有好看的弹窗提示,自己就找了个时间写了一个简单集成 ReactNative 又有好看的更新弹窗;</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ol>
<li>首先是安装 react-native-code-push,  <code>yarn add react-native-code-push</code>;</li>
<li>link 一下项目, <code>react-native link react-native-code-push</code>;</li>
<li>安装 react-native-code-push-dialog, <code>yarn add react-native-code-push-dialog</code>;</li>
</ol>
<h2 id="项目中配置"><a href="#项目中配置" class="headerlink" title="项目中配置"></a>项目中配置</h2><p>最简单的配置如下,尽量把 <HotUpdate /> 节点放在顶层的节点处;</p>
<figure class="highlight plaintext"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import React, &#123;Component&#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;Platform, StyleSheet, Text, View, Button, Dimensions&#125; from &#x27;react-native&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import HotUpdate, &#123; ImmediateCheckCodePush &#125; from &#x27;react-native-code-push-dialog&#x27;;</span><br><span class="line"></span><br><span class="line">export default class Index extends React.Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return &lt;View style=&#123;&#123;flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;&#125;&#125;&gt;</span><br><span class="line">            &lt;Text&gt; CodePushExample &lt;/Text&gt;</span><br><span class="line">            &lt;HotUpdate /&gt;</span><br><span class="line">            &lt;Text onPress=&#123;()=&gt;&#123;</span><br><span class="line">                ImmediateCheckCodePush();</span><br><span class="line">            &#125;&#125;&gt;点击立即检查&lt;/Text&gt;</span><br><span class="line">        &lt;/View&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>更多用法</p>
<table>
<thead>
<tr>
<th align="center">props</th>
<th align="center">PropTypes</th>
<th align="center">use</th>
<th align="center">description</th>
</tr>
</thead>
<tbody><tr>
<td align="center">deploymentKey</td>
<td align="center">PropTypes.string</td>
<td align="center"><code>jaasdasdsa2w12wed2we3e23</code></td>
<td align="center">code-push deploymentKey 非必须参数,没有会读取原生的;</td>
</tr>
<tr>
<td align="center">isActiveCheck</td>
<td align="center">PropTypes.bool</td>
<td align="center"><code>true</code> or <code>false</code></td>
<td align="center">code-push CheckFrequency 检查更新策略,只提供2种, true 每次返回前台就更新(高频率), false 只有 App 启动才检测更新, 默认 true;</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import React, &#123;Component&#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;Platform, StyleSheet, Text, View, Button, Dimensions&#125; from &#x27;react-native&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import HotUpdate, &#123; ImmediateCheckCodePush &#125; from &#x27;react-native-code-push-dialog&#x27;;</span><br><span class="line"></span><br><span class="line">export default class Index extends React.Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return &lt;View style=&#123;&#123;flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;&#125;&#125;&gt;</span><br><span class="line">            &lt;Text&gt; CodePushExample &lt;/Text&gt;</span><br><span class="line">            &lt;HotUpdate deploymentKey=&#123;&#x27;askjdkas32232dw32d&#x27;&#125; isActiveCheck=&#123;false&#125;/&gt;</span><br><span class="line">            &lt;Text onPress=&#123;()=&gt;&#123;</span><br><span class="line">                ImmediateCheckCodePush();</span><br><span class="line">            &#125;&#125;&gt;点击立即检查&lt;/Text&gt;</span><br><span class="line">        &lt;/View&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>推热更新代码的时候如果是有多条类型的,尽量在推更新的时候弄成每条后面回车,这样到时候展示的内容才能换行美观;</p>
<p><code>code-push release-react App android --des &quot;1.按照区域展示轮播内容;                              2.分析数据,优化体验;&quot; -t &quot;5.1.2&quot;</code></p>
<p>显示效果</p>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1fwrho7a10fg20aj0l37bb.gif"></p>
<h2 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/strawferry/CodePushDialog"><strong>GitHub 仓库地址</strong></a></p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2018/03/12/%E5%B0%8F%E5%9E%8B%E5%A4%B1%E7%89%A9%E6%8B%9B%E9%A2%86%E5%90%8E%E7%AB%AF(Koa%20%E7%89%88%E6%9C%AC)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/03/12/%E5%B0%8F%E5%9E%8B%E5%A4%B1%E7%89%A9%E6%8B%9B%E9%A2%86%E5%90%8E%E7%AB%AF(Koa%20%E7%89%88%E6%9C%AC)/" class="post-title-link" itemprop="url">小型失物招领后端(Koa 版本)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-03-12 15:23:42" itemprop="dateCreated datePublished" datetime="2018-03-12T15:23:42+08:00">2018-03-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="小型失物招领后端-Koa-版本"><a href="#小型失物招领后端-Koa-版本" class="headerlink" title="小型失物招领后端(Koa 版本)"></a>小型失物招领后端(Koa 版本)</h1><h2 id="项目说明"><a href="#项目说明" class="headerlink" title="项目说明"></a>项目说明</h2><p>本身是搞 iOS 的后面入了 ReactNative 的坑,慢慢的就比较多的接触 JavaScript ,还有就是 JavaScript 慢慢的可以做的东西越来越多;<br>不仅可以做前端网页,还可以做移动端 App(ReactNative),还能做后端(Node.js),还有其他的;</p>
<p>这个失物招领是为了练手 Node.js,同时也为了配合这个写了个 App 前端(iOS 和 安卓),链接在后面也会放出了;</p>
<p>目前主要的 Feature:  </p>
<ol>
<li>用户登录注册;</li>
<li>基本的管理员权限管理;</li>
<li>失物招领信息发布,关注收藏,通知审核等;</li>
<li>管理员的基本功能的管理与审核;</li>
<li>极光推送对接,使内容实时推送给用户;</li>
</ol>
<h2 id="本地运行条件"><a href="#本地运行条件" class="headerlink" title="本地运行条件"></a>本地运行条件</h2><ul>
<li>MongoDB 数据库</li>
<li>Node.js 环境</li>
</ul>
<h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><ol>
<li>七牛配置<ol>
<li>七牛配置是为了保存图片到七牛;</li>
<li>申请相应的开发者账号,填入到 <code>config文件夹的config文件</code>;</li>
<li>配置错误,或未配置调用到会导致程序崩溃;</li>
</ol>
</li>
</ol>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1form5qgmtaj21x20yin26.jpg"><br><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1form5qgpx8j21x013qn4q.jpg"></p>
</blockquote>
<ol start="2">
<li>极光配置<ol>
<li>使消息即使让用户知道;</li>
<li>申请相应的开发者账号,填入到 <code>config文件夹的config文件</code>;</li>
<li>配置错误,或未配置调用到会导致程序崩溃;</li>
</ol>
</li>
</ol>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1form5qgf31j21ui196jxm.jpg"></p>
</blockquote>
<h2 id="造一些假数据的"><a href="#造一些假数据的" class="headerlink" title="造一些假数据的"></a>造一些假数据的</h2><p>项目目录下执行 <code>node data.js</code> 两次就行;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">超级管理员</span><br><span class="line">用户名: admin@163.com</span><br><span class="line">密码: 123456</span><br><span class="line">其他的用户: user[1 - 10]@163.com 密码: 123456</span><br></pre></td></tr></table></figure>
<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><ul>
<li><p>本地启动 </p>
<ol>
<li>首先启动本地 MongoDB 数据库,项目目录下执行 <code>npm run mongo</code> 数据库跑默认的段口;</li>
<li>项目目录下执行 <code>npm start</code> 启动;</li>
<li><span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo1NTY2L2RvY3M=">就可以打开文档 http://localhost:5566/docs/<i class="fa fa-external-link-alt"></i></span></li>
</ol>
</li>
<li><p>服务器部署(主要使用 <code>pm2</code> 部署)</p>
<ol>
<li>服务器安装 <code>node</code> <code>pm2</code> <code>MongoDB</code> 环境等; </li>
<li>项目目录下执行 <ol>
<li>测试 <code>pm2 start dev.json</code></li>
<li>正式 <code>pm2 start dev.json</code></li>
</ol>
</li>
<li>查看日志 <code>pm2 logs</code></li>
</ol>
</li>
</ul>
<h2 id="对应的客户端"><a href="#对应的客户端" class="headerlink" title="对应的客户端"></a>对应的客户端</h2><ul>
<li>目前就只做了 App 端,按理说目前接口基本可以做个网页前端的,微信公众号以及小程序,在做些修改也是应该可以的;</li>
</ul>
<h2 id="下载体验"><a href="#下载体验" class="headerlink" title="下载体验"></a>下载体验</h2><p>iOS 没有发布,下载安卓体验</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9maXIuaW0vY3B0MQ==">安卓 fir.im 下载<i class="fa fa-external-link-alt"></i></span></p>
<p>或者直接扫码下载</p>
<blockquote>
<p><img data-src="data:image/png;base64,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" alt="扫码下载"></p>
</blockquote>
<h2 id="仓库地址"><a href="#仓库地址" class="headerlink" title="仓库地址"></a>仓库地址</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdHNlcnZlcg==">Express 版本 GitHub 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvb3Blbmxvc3Rrb2E=">Koa 版本 GitHub 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdGFwcA==">App 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<h1 id="个人博客"><a href="#个人博客" class="headerlink" title="个人博客"></a>个人博客</h1><h3 id="博客地址-https-cblog-ferryvip-com"><a href="#博客地址-https-cblog-ferryvip-com" class="headerlink" title="博客地址: https://cblog.ferryvip.com/"></a><strong>博客地址: <a target="_blank" rel="noopener" href="https://cblog.ferryvip.com/"><code>https://cblog.ferryvip.com/</code></a></strong></h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2018/02/26/Log4js%20-%20Appenders%20%E5%BC%80%E5%8F%91,%E6%B6%88%E6%81%AF%E7%9B%B4%E5%8F%91%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/02/26/Log4js%20-%20Appenders%20%E5%BC%80%E5%8F%91,%E6%B6%88%E6%81%AF%E7%9B%B4%E5%8F%91%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA/" class="post-title-link" itemprop="url">Log4js - Appenders 开发,消息直发钉钉机器人</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-26 14:32:51" itemprop="dateCreated datePublished" datetime="2018-02-26T14:32:51+08:00">2018-02-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="项目说明"><a href="#项目说明" class="headerlink" title="项目说明"></a>项目说明</h2><p>在一些 Node 的项目中,一直使用 <code>log4js</code> 的做日志插件,然后发现里面有个 <code>appenders </code> 插件,可以发送消息到国外软件 <code>slack</code> 里,这样就可以便捷的做一些扩展,可是本人最近在用钉钉,而且那个接触也少,所以本着东西(接口文档的)都有,就找了时间自己撸了一个出来.</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>找了一下两家的文档</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/log4js-node/log4js-node"><code>log4js</code> 文档</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://log4js-node.github.io/log4js-node/appenders.html"><code>Log4js - Appenders</code></a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://log4js-node.github.io/log4js-node/slack.html"><code>Slack Appender</code></a></p>
</blockquote>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9vcGVuLWRvYy5kaW5ndGFsay5jb20vZG9jcy9kb2MuaHRtP3NwbT1hMjE5YS43NjI5MTQwLjAuMC5WOFdiMk8mdHJlZUlkPTI1NyZhcnRpY2xlSWQ9MTA1NzM1JmRvY1R5cGU9MQ==">钉钉自定义机器人文档<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><code>npm install --save log4jsdd log4js</code></p>
<h2 id="配置-log4js"><a href="#配置-log4js" class="headerlink" title="配置 log4js"></a>配置 log4js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> log4js = <span class="built_in">require</span>(<span class="string">&#x27;log4js&#x27;</span>);</span><br><span class="line">log4js.<span class="title function_">configure</span>(&#123;</span><br><span class="line">    <span class="attr">appenders</span>: &#123;</span><br><span class="line">        <span class="attr">out</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;stdout&#x27;</span>&#125;,</span><br><span class="line">        <span class="attr">dingding</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;log4jsdd&#x27;</span>,</span><br><span class="line">            <span class="attr">hookUrl</span>: <span class="string">&#x27;填写获取钉钉里面设置的 webhook 地址&#x27;</span>,</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;Node 消息&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">categories</span>: &#123; <span class="attr">default</span>: &#123; <span class="attr">appenders</span>: [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;dingding&#x27;</span>], <span class="attr">level</span>: <span class="string">&#x27;debug&#x27;</span> &#125;&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = log4js.<span class="title function_">getLogger</span>();</span><br><span class="line">app.<span class="title function_">info</span>(<span class="string">&#x27;测试发送到钉钉&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="钉钉机器人配置"><a href="#钉钉机器人配置" class="headerlink" title="钉钉机器人配置"></a>钉钉机器人配置</h2><p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1fotncinog2j21hc0xgwjw.jpg"><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1fotncimouoj21hc0xggpf.jpg"><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1fotncinqkwj21hc0xg0yf.jpg"><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1fotncimw5kj21280uumz6.jpg"><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1fotncin1ebj212a0uutbn.jpg"><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1fotncipj81j21hc0xg7a3.jpg"></p>
<h2 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/strawferry/log4jsdd"><strong>GitHub 仓库地址</strong></a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/log4jsdd"><strong>npm 地址</strong></a></p>
</blockquote>
<h1 id="个人博客"><a href="#个人博客" class="headerlink" title="个人博客"></a>个人博客</h1><h3 id="博客地址-https-cblog-ferryvip-com"><a href="#博客地址-https-cblog-ferryvip-com" class="headerlink" title="博客地址: https://cblog.ferryvip.com/"></a><strong>博客地址: <a target="_blank" rel="noopener" href="https://cblog.ferryvip.com/"><code>https://cblog.ferryvip.com/</code></a></strong></h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2018/02/24/%E5%B0%8F%E5%9E%8B%E5%A4%B1%E7%89%A9%E6%8B%9B%E9%A2%86%20App%20%E5%AE%A2%E6%88%B7%E7%AB%AF(ReactNative)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/02/24/%E5%B0%8F%E5%9E%8B%E5%A4%B1%E7%89%A9%E6%8B%9B%E9%A2%86%20App%20%E5%AE%A2%E6%88%B7%E7%AB%AF(ReactNative)/" class="post-title-link" itemprop="url">小型失物招领 App 客户端(ReactNative)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-24 15:43:02" itemprop="dateCreated datePublished" datetime="2018-02-24T15:43:02+08:00">2018-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="小型失物招领-App-客户端-iOS-安卓"><a href="#小型失物招领-App-客户端-iOS-安卓" class="headerlink" title="小型失物招领 App 客户端(iOS &amp;&amp; 安卓)"></a>小型失物招领 App 客户端(iOS &amp;&amp; 安卓)</h1><h2 id="项目说明"><a href="#项目说明" class="headerlink" title="项目说明"></a>项目说明</h2><p>本身是搞 iOS 的后面入了 ReactNative 的坑,慢慢的就比较多的接触 JavaScript ,还有就是 JavaScript 慢慢的可以做的东西越来越多;<br>不仅可以做前端网页,还可以做移动端 App(ReactNative),还能做后端(Node.js),还有其他的;</p>
<p>这个 App 是为了搭配<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdHNlcnZlcg==">小型失物招领后端<i class="fa fa-external-link-alt"></i></span>所做的,同时也使用了 <code>redux</code> <code>react-navigation</code> 等的做数据管理以及路由切换;</p>
<p>目前主要的 Feature:  </p>
<ol>
<li>用户登录注册;</li>
<li>基本的管理员权限管理;</li>
<li>失物招领信息发布,关注收藏,通知审核等;</li>
<li>管理员的基本功能的管理与审核;</li>
<li>极光推送对接,使内容实时推送给用户;</li>
</ol>
<h2 id="本地运行条件"><a href="#本地运行条件" class="headerlink" title="本地运行条件"></a>本地运行条件</h2><ul>
<li>需要相应后端服务开启,本地 server 服务或者线上 server,下面会有相应的配置说明;</li>
</ul>
<h2 id="下载体验"><a href="#下载体验" class="headerlink" title="下载体验"></a>下载体验</h2><p>iOS 没有发布,下载安卓体验</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9maXIuaW0vY3B0MQ==">安卓 fir.im 下载<i class="fa fa-external-link-alt"></i></span></p>
<p>或者直接扫码下载</p>
<blockquote>
<p><img data-src="data:image/png;base64,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" alt="扫码下载"></p>
</blockquote>
<h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><ul>
<li>代码热更新配置(可不配置);</li>
</ul>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1forvmdtezxj21r41084bn.jpg" alt="iOS"><br><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1forvzfmss4j228g1huniw.jpg" alt="Android"></p>
</blockquote>
<ul>
<li>极光推送 appkey 配置</li>
</ul>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1forvmdt6kmj21ts0xen9o.jpg" alt="iOS"><br><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1forvzfndrzj21q81hudzn.jpg" alt="Android"></p>
</blockquote>
<ul>
<li>后端服务器地址配置</li>
</ul>
<p>把在相应的服务地址填入对应环境中,设置 <code>SET_ENV</code> <code>DEV</code> 为开发地址 <code>APP</code> 为线上地址</p>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1forw8hqeqyj21ri1i4ard.jpg" alt="config"></p>
</blockquote>
<h2 id="仓库地址"><a href="#仓库地址" class="headerlink" title="仓库地址"></a>仓库地址</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdHNlcnZlcg==">服务器地址 GitHub 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdGFwcA==">App 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<h1 id="个人博客"><a href="#个人博客" class="headerlink" title="个人博客"></a>个人博客</h1><h3 id="博客地址-https-cblog-ferryvip-com"><a href="#博客地址-https-cblog-ferryvip-com" class="headerlink" title="博客地址: https://cblog.ferryvip.com/"></a><strong>博客地址: <a target="_blank" rel="noopener" href="https://cblog.ferryvip.com/"><code>https://cblog.ferryvip.com/</code></a></strong></h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2018/02/24/%E5%B0%8F%E5%9E%8B%E5%A4%B1%E7%89%A9%E6%8B%9B%E9%A2%86%E5%90%8E%E7%AB%AF(Express%20%E7%89%88%E6%9C%AC)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/02/24/%E5%B0%8F%E5%9E%8B%E5%A4%B1%E7%89%A9%E6%8B%9B%E9%A2%86%E5%90%8E%E7%AB%AF(Express%20%E7%89%88%E6%9C%AC)/" class="post-title-link" itemprop="url">小型失物招领后端(Express 版本)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-24 13:23:42" itemprop="dateCreated datePublished" datetime="2018-02-24T13:23:42+08:00">2018-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="小型失物招领后端-Express-版本"><a href="#小型失物招领后端-Express-版本" class="headerlink" title="小型失物招领后端(Express 版本)"></a>小型失物招领后端(Express 版本)</h1><h2 id="项目说明"><a href="#项目说明" class="headerlink" title="项目说明"></a>项目说明</h2><p>本身是搞 iOS 的后面入了 ReactNative 的坑,慢慢的就比较多的接触 JavaScript ,还有就是 JavaScript 慢慢的可以做的东西越来越多;<br>不仅可以做前端网页,还可以做移动端 App(ReactNative),还能做后端(Node.js),还有其他的;</p>
<p>这个失物招领是为了练手 Node.js,同时也为了配合这个写了个 App 前端(iOS 和 安卓),链接在后面也会放出了;</p>
<p>目前主要的 Feature:  </p>
<ol>
<li>用户登录注册;</li>
<li>基本的管理员权限管理;</li>
<li>失物招领信息发布,关注收藏,通知审核等;</li>
<li>管理员的基本功能的管理与审核;</li>
<li>极光推送对接,使内容实时推送给用户;</li>
</ol>
<h2 id="本地运行条件"><a href="#本地运行条件" class="headerlink" title="本地运行条件"></a>本地运行条件</h2><ul>
<li>MongoDB 数据库</li>
<li>Node.js 环境</li>
</ul>
<h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><ol>
<li>七牛配置<ol>
<li>七牛配置是为了保存图片到七牛;</li>
<li>申请相应的开发者账号,填入到 <code>config文件夹的config文件</code>;</li>
<li>配置错误,或未配置调用到会导致程序崩溃;</li>
</ol>
</li>
</ol>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1form5qgmtaj21x20yin26.jpg"><br><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1form5qgpx8j21x013qn4q.jpg"></p>
</blockquote>
<ol start="2">
<li>极光配置<ol>
<li>使消息即使让用户知道;</li>
<li>申请相应的开发者账号,填入到 <code>config文件夹的config文件</code>;</li>
<li>配置错误,或未配置调用到会导致程序崩溃;</li>
</ol>
</li>
</ol>
<blockquote>
<p><img data-src="http://ww1.sinaimg.cn/large/8bbf0afbly1form5qgf31j21ui196jxm.jpg"></p>
</blockquote>
<h2 id="造一些假数据的"><a href="#造一些假数据的" class="headerlink" title="造一些假数据的"></a>造一些假数据的</h2><p>项目目录下执行 <code>node data.js</code> 两次就行;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">超级管理员</span><br><span class="line">用户名: admin@163.com</span><br><span class="line">密码: 123456</span><br><span class="line">其他的用户: user[1 - 10]@163.com 密码: 123456</span><br></pre></td></tr></table></figure>
<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><ul>
<li><p>本地启动 </p>
<ol>
<li>首先启动本地 MongoDB 数据库,项目目录下执行 <code>npm run mongo</code> 数据库跑默认的段口;</li>
<li>项目目录下执行 <code>npm start</code> 启动;</li>
<li><span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo1NTY2L2RvY3M=">就可以打开文档 http://localhost:5566/docs<i class="fa fa-external-link-alt"></i></span></li>
</ol>
</li>
<li><p>服务器部署(主要使用 <code>pm2</code> 部署)</p>
<ol>
<li>服务器安装 <code>node</code> <code>pm2</code> <code>MongoDB</code> 环境等; </li>
<li>项目目录下执行 <ol>
<li>测试 <code>pm2 start dev.json</code></li>
<li>正式 <code>pm2 start dev.json</code></li>
</ol>
</li>
<li>查看日志 <code>pm2 logs</code></li>
</ol>
</li>
</ul>
<h2 id="对应的客户端"><a href="#对应的客户端" class="headerlink" title="对应的客户端"></a>对应的客户端</h2><ul>
<li>目前就只做了 App 端,按理说目前接口基本可以做个网页前端的,微信公众号以及小程序,在做些修改也是应该可以的;</li>
</ul>
<h2 id="下载体验"><a href="#下载体验" class="headerlink" title="下载体验"></a>下载体验</h2><p>iOS 没有发布,下载安卓体验</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9maXIuaW0vY3B0MQ==">安卓 fir.im 下载<i class="fa fa-external-link-alt"></i></span></p>
<p>或者直接扫码下载</p>
<blockquote>
<p><img data-src="data:image/png;base64,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" alt="扫码下载"></p>
</blockquote>
<h2 id="仓库地址"><a href="#仓库地址" class="headerlink" title="仓库地址"></a>仓库地址</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdHNlcnZlcg==">服务器地址 GitHub 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvbG9zdGFwcA==">App 地址,具体配置看文档<i class="fa fa-external-link-alt"></i></span></p>
<h1 id="个人博客"><a href="#个人博客" class="headerlink" title="个人博客"></a>个人博客</h1><h3 id="博客地址-https-cblog-ferryvip-com"><a href="#博客地址-https-cblog-ferryvip-com" class="headerlink" title="博客地址: https://cblog.ferryvip.com/"></a><strong>博客地址: <a target="_blank" rel="noopener" href="https://cblog.ferryvip.com/"><code>https://cblog.ferryvip.com/</code></a></strong></h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2017/08/16/Coding%E8%AE%BE%E7%BD%AEWebhook%E5%88%B0%E9%92%89%E9%92%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/08/16/Coding%E8%AE%BE%E7%BD%AEWebhook%E5%88%B0%E9%92%89%E9%92%89/" class="post-title-link" itemprop="url">Coding设置Webhook到钉钉</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-08-16 11:22:51" itemprop="dateCreated datePublished" datetime="2017-08-16T11:22:51+08:00">2017-08-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>最近用着钉钉,突然发现有个神奇的功能叫 Webhook 机器人,里面有 <code>Github</code> 的机器人,然鹅竟然没有我一直在用的 <strong><span class="exturl" data-url="aHR0cHM6Ly9jb2RpbmcubmV0Lw==">Coding.net<i class="fa fa-external-link-alt"></i></span></strong> 的机器人,这个不能忍,本着程序员自己动手丰衣足食的勤劳准则,想着就自己折腾弄一个玩玩;</p>
<p>因为自己只会点 <code>Node.js</code> 所以就做了个包,具体的看下面;</p>
<p>效果图</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4rbgug21ka0w77hd.gif"></p>
</blockquote>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>找了一下两家的文档</p>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9vcGVuLmNvZGluZy5uZXQvd2ViaG9va3Mv">Coding Webhook 文档<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9vcGVuLWRvYy5kaW5ndGFsay5jb20vZG9jcy9kb2MuaHRtP3NwbT1hMjE5YS43NjI5MTQwLjAuMC5WOFdiMk8mdHJlZUlkPTI1NyZhcnRpY2xlSWQ9MTA1NzM1JmRvY1R5cGU9MQ==">钉钉自定义机器人文档<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>大概原理就是,钉钉提供一个发送消息的 Webhook 地址给你,然后 Coding 家提供了一个给你填入 Webhook 的地址接口,当仓库有信息变化,就会给你这个地址接口发消息;然而钉钉没有做这个 Coding 的接口,所以不能提供 Coding 直接把消息发到钉钉上,所以只能自己搭个服务器,先把 Coding 的消息解析一下,在发给钉钉.基本原理就是这样,说的有点乱,哈哈;</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filia2e2chj21pe15sjz0.jpg"></p>
</blockquote>
<h2 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h2><p>设置 Webhook 路由;</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>),</span><br><span class="line">    bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>),</span><br><span class="line">    <span class="variable constant_">CWD</span> = <span class="built_in">require</span>(<span class="string">&#x27;./../index&#x27;</span>),</span><br><span class="line">    app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一般都会设置 bodyParser ,需要用到; </span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置 Webhook 路由,已经中间件 CWD</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/webhook&#x27;</span>, <span class="title function_">CWD</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">5566</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server listening on port http://localhost:6666&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>CWD 中间件;</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"><span class="built_in">exports</span> = <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">CodingHookDingDing</span> (req, res, next) &#123;</span><br><span class="line">        <span class="keyword">let</span> event = req.<span class="property">headers</span>[<span class="string">&#x27;x-coding-event&#x27;</span>],</span><br><span class="line">            body = req.<span class="property">body</span>;</span><br><span class="line">            <span class="comment">// 通过头文件的 event 事件判断传入的参数等,做相应的信息解析;</span></span><br><span class="line">        <span class="keyword">switch</span> (event)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;push&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="title class_">Push</span>(req, res, next); <span class="comment">// 对 push 做解析</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;ping&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;</span><br><span class="line">                    <span class="string">&quot;token&quot;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;zen&quot;</span>: <span class="string">&quot;Coding！ 让开发更简单&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">json</span>(body);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Push</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">	<span class="comment">/*-- 消息的解析拼接 --*/</span></span><br><span class="line">    <span class="keyword">let</span> body = req.<span class="property">body</span>;</span><br><span class="line">    <span class="keyword">let</span> ding = body.<span class="property">token</span>;</span><br><span class="line">    <span class="keyword">let</span> count = body.<span class="property">commits</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">let</span> whopush = body.<span class="property">commits</span>[<span class="number">0</span>].<span class="property">committer</span>.<span class="property">name</span>;</span><br><span class="line">    <span class="keyword">let</span> repourl = <span class="string">`<span class="subst">$&#123;body.repository.owner.web_url&#125;</span>/p/<span class="subst">$&#123;body.repository.name&#125;</span>/git/tree/<span class="subst">$&#123;getbranch(body.ref)&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">let</span> branch = <span class="string">`# [[<span class="subst">$&#123;body.repository.name&#125;</span>/<span class="subst">$&#123;getbranch(body.ref)&#125;</span>]](<span class="subst">$&#123;repourl&#125;</span>)`</span>;</span><br><span class="line">    <span class="keyword">let</span> text = <span class="string">`<span class="subst">$&#123;branch&#125;</span> <span class="subst">$&#123;count&#125;</span> commit,push by <span class="subst">$&#123;whopush&#125;</span>\n ## commits:\n`</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; count; i++)&#123;</span><br><span class="line">        <span class="keyword">let</span> com = body.<span class="property">commits</span>[i];</span><br><span class="line">        <span class="keyword">let</span> name = com.<span class="property">committer</span>.<span class="property">name</span>;</span><br><span class="line">        <span class="keyword">let</span> mes = com.<span class="property">short_message</span>;</span><br><span class="line">        <span class="keyword">let</span> hash6 = com.<span class="property">sha</span>.<span class="title function_">substring</span>(<span class="number">0</span>,<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">let</span> commit = <span class="string">`&gt; &lt;/&gt; <span class="subst">$&#123;name&#125;</span>: [[<span class="subst">$&#123;hash6&#125;</span>]](<span class="subst">$&#123;com.web_url&#125;</span>)-<span class="subst">$&#123;mes&#125;</span>\n`</span>;</span><br><span class="line">        text = text + commit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(text);</span><br><span class="line">    <span class="comment">/*-- 消息的解析拼接 --*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 钉钉消息格式等 body 设置 </span></span><br><span class="line">    <span class="keyword">let</span> rqbody = &#123;</span><br><span class="line">        <span class="attr">msgtype</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">        <span class="attr">markdown</span>: &#123;</span><br><span class="line">            <span class="attr">title</span>:<span class="string">&quot;仓库有新的代码更新咯!&quot;</span>,</span><br><span class="line">            <span class="attr">text</span>: text</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> options = &#123;</span><br><span class="line">        <span class="attr">url</span>: ding,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(rqbody) <span class="comment">// 消息体内容</span></span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="comment">// request 向钉钉发送消息 Webhook</span></span><br><span class="line">    request.<span class="title function_">post</span>(options, <span class="function">(<span class="params">err, res, body</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!err &amp;&amp; res.<span class="property">statusCode</span> == <span class="number">200</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> info = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(body);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(info);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    res.<span class="title function_">json</span>(&#123;<span class="attr">mes</span>: <span class="string">&#x27;ok&#x27;</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getbranch</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> arr = str.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> arr[arr.<span class="property">length</span>-<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="1-首先钉钉群里设置自定义机器人"><a href="#1-首先钉钉群里设置自定义机器人" class="headerlink" title="1. 首先钉钉群里设置自定义机器人"></a>1. 首先钉钉群里设置自定义机器人</h3><p><strong>1. 设置自定义机器人</strong></p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4pd50j20mv0n479k.jpg"></p>
</blockquote>
<p><strong>2. 填入机器人名称</strong></p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4ortwj20ix0ffq46.jpg"></p>
</blockquote>
<p><strong>3. 复制 webhook 地址,后面有用</strong><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4omjxj20iy0ffmyo.jpg"></p>
<h3 id="2-Coding-仓库-Webhook-设置"><a href="#2-Coding-仓库-Webhook-设置" class="headerlink" title="2. Coding 仓库 Webhook 设置"></a>2. Coding 仓库 Webhook 设置</h3><p><strong>1. 点击到要设置的仓库 Webhook 页面,点击新建 Webhook</strong></p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4p9tbj20yf0egq5j.jpg"></p>
</blockquote>
<p><strong>2. url 填入服务器上要监听的地址, token 填入刚才钉钉复制的 Webhook 地址,以及选取底部的监听类型,至少要勾选 Push</strong></p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4qf5fj21a40qajwl.jpg"></p>
</blockquote>
<p><strong>3. 如果配置顺利,在你以后每次仓库的变化,在钉钉上面都会收到消息提醒</strong></p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1filid4tw0uj20qo0v4wnh.jpg"></p>
</blockquote>
<h2 id="npm-包"><a href="#npm-包" class="headerlink" title="npm 包"></a>npm 包</h2><p>后面就干脆做了个 npm 包发布上去,目前只对 push 操作做消息发送,后续有时间在完善下其他操作;</p>
<blockquote>
<p>安装</p>
</blockquote>
<p><code>npm i --save hookding</code></p>
<blockquote>
<p>使用方法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">CWD</span> = <span class="built_in">require</span>(<span class="string">&#x27;hookding&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/router&#x27;</span>, <span class="title function_">CWD</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="本文参与-Coding-征文计划"><a href="#本文参与-Coding-征文计划" class="headerlink" title="本文参与 Coding 征文计划"></a><span class="exturl" data-url="aHR0cHM6Ly9jb2RpbmcubmV0L3dvdy9zdG9yaWVzLw==">本文参与 Coding 征文计划<i class="fa fa-external-link-alt"></i></span></h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2017/08/15/curl%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/08/15/curl%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">curl命令使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-08-15 17:04:22" itemprop="dateCreated datePublished" datetime="2017-08-15T17:04:22+08:00">2017-08-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="curl-基本使用"><a href="#curl-基本使用" class="headerlink" title="curl 基本使用"></a>curl 基本使用</h1><ol>
<li>最简单的直接请求页面 <code>curl &quot;https://www.baidu.com&quot;</code></li>
<li>请求保存页面 <code> curl &quot;https://www.baidu.com&quot; &gt; /path/name.html</code> </li>
<li><code>-o</code> 保存页面 <code>curl -o /path/name.html &quot;https://www.baidu.com&quot;</code> <code>--progress </code> 显示进度条</li>
<li><code>-s</code> 加入这个就不会出现进度条,安静模式</li>
<li><code>-A</code> 参数用来指定 USER-AGENGT <code>curl -A &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.52 Safari/537.17&quot; http://localhost/learing-curl/show-server-info.php</code></li>
<li><code>-e</code> 指定 referer 来源网址 <code>curl -e &quot;https://www.google.com/&quot;  http://localhost/learing-curl/show-server-info.php</code></li>
<li><code>-d</code> post 请求 <code>curl -d &quot;name=1&quot; &quot;http://localhost:6666/post&quot;</code></li>
<li><code>-G</code> 轻质指定表单以 GET 方法提交</li>
<li><code>-I</code> 只展示 Header <code>curl -I  http://www.baidu.com</code></li>
<li><code>-D</code> 保存 Header 到文件里 <code>curl -D header.txt http://www.alibaba.com</code></li>
<li><code>-L</code> 跟随重定向过去 <code>curl -L http:localhost:6666/red</code></li>
<li><code>-F</code> 提交文件 <code> curl -F upload_file=@test.data url</code></li>
<li><code>-c</code> 保存 cookie <code>curl -c cookie.txt https://www.baidu.com</code></li>
<li><code>-b</code> 带 coolie 访问 <code>curl -b &quot;name=data&quot; url</code> <code>curl -b cookie.txt url</code></li>
<li><code>-H</code> 设置请求头</li>
<li><code>-m</code> 设置最大传输时间 seconds </li>
<li><code>-u</code> 设置服务器用户名和密码 <code>curl -u name:password url</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&#x27;https://oapi.dingtalk.com/robot/send?access_token=6fb5741248b308d1eb616f993fddf0fb3459f42cb6b4eb86078e33042b5bc4e0&#x27;</span> \</span><br><span class="line">   -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">   -d \</span><br><span class="line">  <span class="string">&#x27;&#123;&quot;msgtype&quot;: &quot;text&quot;, </span></span><br><span class="line"><span class="string">    &quot;text&quot;: &#123;</span></span><br><span class="line"><span class="string">        &quot;content&quot;: &quot;我就是我, 是不一样的烟火&quot;</span></span><br><span class="line"><span class="string">     &#125;</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://www.ferryvip.com/v1/me/webhook&#x27;</span> \</span><br><span class="line">   -H <span class="string">&#x27;Content-Type: application/json &#x27;</span> \</span><br><span class="line">   -H <span class="string">&#x27;x-coding-event: push &#x27;</span> \</span><br><span class="line">   -d \</span><br><span class="line">  <span class="string">&#x27;&#123;&quot;ref&quot;:&quot;refs/heads/master&quot;,&quot;before&quot;:&quot;fbec0e3aa41f1364587c5d62df9032bcc5406afd&quot;,&quot;commits&quot;:[&#123;&quot;committer&quot;:&#123;&quot;name&quot;:&quot;chencangshan&quot;,&quot;email&quot;:&quot;chencangshan@huaxiweiying.com&quot;&#125;,&quot;web_url&quot;:&quot;https://coding.net/u/ferryVip/p/lostwebserver/git/commit/90360e33395e3bb1e1b844b4b85de08d2a559152&quot;,&quot;short_message&quot;:&quot;测试 hook\n&quot;,&quot;sha&quot;:&quot;90360e33395e3bb1e1b844b4b85de08d2a559152&quot;&#125;],&quot;after&quot;:&quot;90360e33395e3bb1e1b844b4b85ded2a559152&quot;,&quot;event&quot;:&quot;push&quot;,&quot;repository&quot;:&#123;&quot;owner&quot;:&#123;&quot;path&quot;:&quot;/u/ferryVip&quot;,&quot;web_url&quot;:&quot;https://coding.net/u/ferryVip&quot;,&quot;global_key&quot;:&quot;ferryVip&quot;,&quot;name&quot;:&quot;ferryVip&quot;,&quot;avatar&quot;:&quot;https://dn-coding-net-production-static.qbox.me/82b7ce57-96ef-4faf-a480-bb0645ab2a1a.jpg?imageMogr2/auto-orient/format/jpeg/crop/!200x200a0a0&quot;&#125;,&quot;https_url&quot;:&quot;https://git.coding.net/ferryVip/lostwebserver.git&quot;,&quot;web_url&quot;:&quot;https://coding.net/u/ferryVip/p/lostwebserver&quot;,&quot;project_id&quot;:&quot;1219048&quot;,&quot;ssh_url&quot;:&quot;git@git.coding.net:ferryVip/lostwebserver.git&quot;,&quot;name&quot;:&quot;lostwebserver&quot;,&quot;description&quot;:&quot;react webpack node mongodb express\n\n失物招领b server&quot;&#125;,&quot;user&quot;:&#123;&quot;path&quot;:&quot;/u/ferryVip&quot;,&quot;web_url&quot;:&quot;https://coding.net/u/ferryVip&quot;,&quot;global_key&quot;:&quot;ferryVip&quot;,&quot;name&quot;:&quot;ferryVip&quot;,&quot;avatar&quot;:&quot;https://dn-coding-net-production-static.qbox.me/82b7ce57-96ef-4faf-a480-bb0645ab2a1a.jpg?imageMogr2/auto-orient/format/jpeg/crop/!200x200a0a0&quot;&#125;,&quot;token&quot;:&quot;https://oapi.dingtalk.com/robot/send?access_token=6fb5741248b308d1eb616f993fddf0fb3459f42cb6b4eb86078e33042b5bc4e0&quot;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2017/05/20/ReactNative%E4%BB%BF%E9%80%A0ofo%20%E5%85%B1%E4%BA%AB%E5%8D%95%E8%BD%A6%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%E7%9A%84app/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/05/20/ReactNative%E4%BB%BF%E9%80%A0ofo%20%E5%85%B1%E4%BA%AB%E5%8D%95%E8%BD%A6%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%E7%9A%84app/" class="post-title-link" itemprop="url">ReactNative 仿造 ofo 共享单车快速开发的app</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-05-20 00:18:58" itemprop="dateCreated datePublished" datetime="2017-05-20T00:18:58+08:00">2017-05-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ofo-ReactNative-仿版-主要是做-iOS版本"><a href="#ofo-ReactNative-仿版-主要是做-iOS版本" class="headerlink" title="ofo ReactNative 仿版(主要是做 iOS版本)"></a>ofo ReactNative 仿版(主要是做 iOS版本)</h1><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>之前一直想做个 ReactNative 关于地图相关的 demo ,然后近两天在群里看见有人发的 RN 做的 ofo 共享单车的仿版(主要是针对安卓的),就想着乘着这几天活不多,也做一个,用下最新的 RN 版本(0.44),本来是想体验一下一些新特性的,目前主要还是在40以下做项目,主要考虑版本兼容,不过目前看也差不多可以升级40以上了,至于这个 ofo 仿版还是有很多没有用到新的特性的东西,好了话不多说,上效果图;</p>
<h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><table>
<thead>
<tr>
<th align="center">iOS</th>
<th align="center">安卓</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1ffr4h8o0ejg209w0hh7wk.gif"></td>
<td align="center"><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1ffr4h8chjig20820eye81.gif"></td>
</tr>
</tbody></table>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a><code>package.json</code></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;native-base&quot;</span>: <span class="string">&quot;^2.1.3&quot;</span>,</span><br><span class="line"><span class="string">&quot;react&quot;</span>: <span class="string">&quot;16.0.0-alpha.6&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native&quot;</span>: <span class="string">&quot;0.44.0&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native-blur&quot;</span>: <span class="string">&quot;^3.0.0-alpha&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native-camera&quot;</span>: <span class="string">&quot;^0.8.0&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native-maps&quot;</span>: <span class="string">&quot;^0.15.0&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native-scrollable-tab-view&quot;</span>: <span class="string">&quot;^0.6.6&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native-share&quot;</span>: <span class="string">&quot;^1.0.20&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-native-simple-toast&quot;</span>: <span class="string">&quot;^0.0.6&quot;</span>,</span><br><span class="line"><span class="string">&quot;react-navigation&quot;</span>: <span class="string">&quot;^1.0.0-beta.9&quot;</span></span><br></pre></td></tr></table></figure>

<p>主要用到的一些依赖,时间比较匆忙,有些没有兼容两个平台,特别是安卓,地图的没有做到很详细;</p>
<h2 id="项目怎么跑起来"><a href="#项目怎么跑起来" class="headerlink" title="项目怎么跑起来"></a>项目怎么跑起来</h2><ol>
<li>把本仓库下载或者克隆下来; <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0cmF3ZmVycnkvcmVhY3RuYXRpdmVvZm8=">Github 地址: <i class="fa fa-external-link-alt"></i></span> <code>https://github.com/strawferry/reactnativeofo</code></li>
<li>前往仓库目录,终端执行 <code>npm install</code> 或者 <code>yarn</code>;</li>
<li>终端执行 <code>react-native link</code>,链接相关的依赖;</li>
<li>然后运行项目;</li>
</ol>
<h2 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h2><p>当时在群里看到这个仓库,发现做的还不错,但是主要是针对安卓的,当时 iOS 适配比较差,就想着搞一个出来;<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL01hcm5vRGV2L3JlYWN0LW5hdGl2ZS1vZm8=">React Native 仿 ofo 共享单车 App http://www.marno.cn<i class="fa fa-external-link-alt"></i></span></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://strawferry.github.io/2017/04/16/%E5%88%A9%E7%94%A8%20Travis%20CL%20%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%20hexo%20%E5%8D%9A%E5%AE%A2%E5%88%B0%20GitHub%20Pages%20%E4%B8%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/strawferry/GSS@master/uPic/2023-08-20/icon-11-57-fa4iZT.jpg">
      <meta itemprop="name" content="FerryVip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FerryVip's Blog">
      <meta itemprop="description" content="好好过一生">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FerryVip's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/04/16/%E5%88%A9%E7%94%A8%20Travis%20CL%20%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%20hexo%20%E5%8D%9A%E5%AE%A2%E5%88%B0%20GitHub%20Pages%20%E4%B8%8A/" class="post-title-link" itemprop="url">利用 Travis CI 自动部署 hexo 博客到 GitHub Pages 上</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-04-16 17:26:34" itemprop="dateCreated datePublished" datetime="2017-04-16T17:26:34+08:00">2017-04-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-20 09:56:56" itemprop="dateModified" datetime="2023-08-20T09:56:56+08:00">2023-08-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近一直在看一些关于持续集成的东西,持续集成会对整个项目的敏捷开发有很大的帮助;</p>
<p>了解过 jenkins, 功能非常强大,但是在做 iOS 持续集成必须在一台 Mac 系统下,后面通过了解和别人介绍,认识到了今天的主角 Travis CI;</p>
<p>hexo虽然可以方便地部署github静态博客，但是仅仅是把最终生成的html保存在repository中，像原始的Markdown文件，hexo配置文件，主题配置文件，修改文件都仅仅是保存在本地。这样不利于保存，也无法查看每篇博客的修改历史。更重要的是无法做到跨平台，也不易于多人写作。</p>
<p>想法是每次写博客，只需要push md文件及博客所需的资源文件即可。Travis CI持续集成tool可以满足此需求。</p>
<p>Travis CI 目前主要是和 GitHub 一起使用,所以今天的例子就以 hexo 博客的每次 push 触发 Travis CI 自动部署到 GitHub 的 Pages 上;</p>
<h2 id="1-思路"><a href="#1-思路" class="headerlink" title="1. 思路"></a>1. 思路</h2><blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feoojwv4fej20r20cpwje.jpg"></p>
</blockquote>
<h2 id="2-具体实现"><a href="#2-具体实现" class="headerlink" title="2. 具体实现"></a>2. 具体实现</h2><h3 id="2-1-首先需要在-GitHub-上面创建一个仓库-或者已有"><a href="#2-1-首先需要在-GitHub-上面创建一个仓库-或者已有" class="headerlink" title="2.1 首先需要在 GitHub 上面创建一个仓库(或者已有)"></a>2.1 首先需要在 GitHub 上面创建一个仓库(或者已有)</h3><blockquote>
<p>以新建仓库为例</p>
</blockquote>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feoow4xyehj20ke0esad6.jpg"></p>
</blockquote>
<h3 id="2-2-生成-Personal-Access-tokens"><a href="#2-2-生成-Personal-Access-tokens" class="headerlink" title="2.2 生成 Personal Access tokens"></a>2.2 生成 Personal Access tokens</h3><blockquote>
<p>为后续的功能生成的 token</p>
</blockquote>
<p>登录github, settings -&gt; Personal access tokens -&gt; Generate new token</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feoow57epmj21nk1a4n60.jpg"></p>
</blockquote>
<p>填写token description，比如叫 travis.并勾选上授予的权限，比如我勾选的是repo和gist，然后create.</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feoow4xvs2j20l60e0tci.jpg"></p>
</blockquote>
<p>将产生的token串复制保留下来，后面会使用到,如果丢失，只能重新产生。</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feoow4xzrej20l50aujvg.jpg"></p>
</blockquote>
<h3 id="2-3-travis-ci-设置"><a href="#2-3-travis-ci-设置" class="headerlink" title="2.3 travis-ci 设置"></a>2.3 <span class="exturl" data-url="aHR0cHM6Ly90cmF2aXMtY2kub3JnLw==">travis-ci 设置<i class="fa fa-external-link-alt"></i></span></h3><p>登录 travis-ci 网站,利用 GitHub 账号登录;</p>
<p>同步 GitHub 仓库</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feopcj6xuqj20ug0ctjv3.jpg"></p>
</blockquote>
<p>选取刚才创建的仓库并打开</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feopcj4vwfj20d808fgmt.jpg"></p>
</blockquote>
<p>添加刚才的 token 作为全局变量</p>
<blockquote>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feopcj8aw7j20v60ql7b3.jpg"></p>
</blockquote>
<h3 id="2-4-hexo-博客设置"><a href="#2-4-hexo-博客设置" class="headerlink" title="2.4 hexo 博客设置"></a>2.4 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlvLw==">hexo 博客设置<i class="fa fa-external-link-alt"></i></span></h3><p>基本的 hexo 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">hexo init blog</span><br><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line">npm install</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure>
<p>进入 blog 所在的文件夹下，新建 <code>.travis.yml</code> 文件，并添加以下内容</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 使用语言</span><br><span class="line"><span class="attr">language</span>: node_js</span><br><span class="line"># node版本</span><br><span class="line"><span class="attr">node_js</span>: stable</span><br><span class="line"># 设置只监听哪个分支</span><br><span class="line"><span class="attr">branches</span>:</span><br><span class="line">  <span class="attr">only</span>:</span><br><span class="line">  - source</span><br><span class="line"># 缓存，可以节省集成的时间，这里我用了yarn，如果不用可以删除</span><br><span class="line"><span class="attr">cache</span>:</span><br><span class="line">  <span class="attr">apt</span>: <span class="literal">true</span></span><br><span class="line">  <span class="attr">yarn</span>: <span class="literal">true</span></span><br><span class="line">  <span class="attr">directories</span>:</span><br><span class="line">    - node_modules</span><br><span class="line"># tarvis生命周期执行顺序详见官网文档</span><br><span class="line"><span class="attr">before_install</span>:</span><br><span class="line">- git config --<span class="variable language_">global</span> user.<span class="property">name</span> <span class="string">&quot;name&quot;</span></span><br><span class="line">- git config --<span class="variable language_">global</span> user.<span class="property">email</span> <span class="string">&quot;mmail@mail.com&quot;</span></span><br><span class="line"># 由于使用了yarn，所以需要下载，如不用yarn这两行可以删除</span><br><span class="line">- curl -o- -L <span class="attr">https</span>:<span class="comment">//yarnpkg.com/install.sh | bash</span></span><br><span class="line">- <span class="keyword">export</span> <span class="variable constant_">PATH</span>=$HOME/.<span class="property">yarn</span>/<span class="attr">bin</span>:$PATH</span><br><span class="line">- npm install -g hexo-cli</span><br><span class="line"><span class="attr">install</span>:</span><br><span class="line"># 不用yarn的话这里改成 npm i 即可</span><br><span class="line">- yarn</span><br><span class="line"><span class="attr">script</span>:</span><br><span class="line">- hexo clean</span><br><span class="line">- hexo generate</span><br><span class="line"><span class="attr">after_success</span>:</span><br><span class="line">- cd ./public</span><br><span class="line">- git init</span><br><span class="line">- git add --all .</span><br><span class="line">- git commit -m <span class="string">&quot;Travis CI Auto Builder&quot;</span></span><br><span class="line"># 这里的 <span class="variable constant_">REPO_TOKEN</span> 即之前在 travis 项目的环境变量里添加的</span><br><span class="line">- git push --quiet --force <span class="attr">https</span>:<span class="comment">//$REPO_TOKEN@git@github.com/strawferry/FerryVipBlog.git master</span></span><br></pre></td></tr></table></figure>
<p>然后，准备 push 该项目到 github ，如果是新项目可参照下面的git指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line"><span class="comment"># 添加自己的项目</span></span><br><span class="line">git remote add origin git@github.com:strawferry/travis.git</span><br><span class="line"><span class="comment"># 新建并切换分支</span></span><br><span class="line">git checkout --orphan <span class="built_in">source</span></span><br><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">&quot;init repo&quot;</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<h3 id="2-5-发布博客文章"><a href="#2-5-发布博客文章" class="headerlink" title="2.5 发布博客文章"></a>2.5 发布博客文章</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">前往 <span class="built_in">source</span> 分支下:</span><br><span class="line">hexo new title   // 1. 新建文章;</span><br><span class="line">2. 使用 markdown 软件或者 vim 直接编写文章内容,并保存文件;</span><br><span class="line">3. 把目前分支的内容变化提交到 git 线上仓库;</span><br><span class="line">4. 接着就等待 travis-ci 自动部署到 pages 上;</span><br></pre></td></tr></table></figure>
<p><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feouarcga0j20uy0sqn63.jpg"><br><img data-src="https://ws1.sinaimg.cn/large/8bbf0afbly1feouaresa4j20mx0s0k4r.jpg"></p>
<p>这样你的博客就已经成功部署到 pages 上面了</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这个是一个简单的对 travis-ci 的入门,这样能够给我们提供不少的事,持续集成能够给开发带来极大的便利,让程序员不做一些重复的事情,提高效率;</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2016 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-star"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">FerryVip</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js","integrity":"sha256-9y71g5Lz/KLsHjB8uXwnkuWDtAMDSzD/HdIbqhJfTAI="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
